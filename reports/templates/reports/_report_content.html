{% load report_extras %}
<!-- Zebra header (upprepas på varje sida i PDF) -->
<div class="zebra-header" aria-hidden="true"></div>

<section class="page page-intro">
  <div class="section-label">INLEDNING</div>

  <h2 class="page-title">Om självskattning och naturligt beteende</h2>

  <div class="lead">
    <p>
      Denna rapport bygger enbart på <strong>din egen skattning</strong> av hur du brukar agera i olika
      arbetssituationer.
    </p>
  </div>

  <div class="body-text">
    <p>
      Resultaten ska därför inte ses som ett facit eller som en beskrivning av hur du kan eller bör
      bete dig i alla sammanhang. De speglar i stället de beteenden som i nuläget faller dig mest
      naturligt, samt de områden där du oftast hämtar energi i ditt ledarskap.
    </p>

    <p>
      Eftersom olika beteenden fyller olika funktioner är det varken möjligt eller eftersträvansvärt att
      ligga högt på allt. Rapporten visar i stället vilka arbetssätt som kommer lätt för dig och var du i
      vissa situationer kan behöva en mer medveten anpassning, beroende på sammanhang och krav i rollen.
    </p>

    <p>
      Rapporten är ett verktyg för självinsikt och reflektion, inte en värdering av prestation eller
      förmåga. Den kan hjälpa dig att förstå vilka beteenden som kommer mer naturligt för dig, och vilka
      som kan kräva mer energi att använda. Tillsammans utgör dessa en grund för fortsatt utveckling inom
      ramen för B3:s ledarskapsprogram.
    </p>
  </div>

  <h3 class="section-title">Tolkning av skalan</h3>
  <div class="body-text">
  <p>
    Skalan beskriver i vilken grad olika beteenden upplevs som naturliga och energigivande för dig.
  </p>
  </div>


  <div class="scale-card">
    <!-- Rad 1 -->
    <div class="scale-row">
      <div class="dots" aria-label="Skalnivå 1 av 5">
        <span class="dot is-on"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
      <div class="scale-text">
        Detta beteende ligger i nuläget <strong>långt ifrån</strong> ditt naturliga sätt att agera och kan
        <strong>kräva mer</strong> medveten ansträngning och energi att använda.
      </div>
    </div>

    <!-- Rad 2 -->
    <div class="scale-row">
      <div class="dots" aria-label="Skalnivå 2 av 5">
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
      <div class="scale-text">
        Detta beteende känns <strong>mindre naturligt</strong> för dig och kan i många situationer upplevas som
        <strong>mer energikrävande</strong> än energigivande.
      </div>
    </div>

    <!-- Rad 3 -->
    <div class="scale-row">
      <div class="dots" aria-label="Skalnivå 3 av 5">
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
      <div class="scale-text">
        Detta beteende kan du <strong>använda vid behov</strong> och upplevs ofta som (över tid)
        <strong>energimässigt neutralt</strong>, ibland naturligt, ibland mindre.
      </div>
    </div>

    <!-- Rad 4 -->
    <div class="scale-row">
      <div class="dots" aria-label="Skalnivå 4 av 5">
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot"></span>
      </div>
      <div class="scale-text">
        Detta beteende <strong>ligger nära</strong> ditt naturliga sätt att agera och ger dig i många sammanhang
        sannolikt <strong>energi att använda</strong>.
      </div>
    </div>

    <!-- Rad 5 -->
    <div class="scale-row">
      <div class="dots" aria-label="Skalnivå 5 av 5">
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
        <span class="dot is-on"></span>
      </div>
      <div class="scale-text">
        Detta beteende är <strong>mycket naturligt</strong> för dig och upplevs i många situationer som
        <strong>energigivande</strong> och <strong>lätt att agera utifrån</strong>.
      </div>
    </div>
  </div>
</section>


<section class="page page-overview">

  <header class="page-header center">
    <h2 class="page-title-xl">Översikt över dina<br>ledarskapsbeteenden</h2>
    <p class="page-subtitle">
      Denna rapport bygger helt på din egen skattning av hur du<br>
      brukar agera i olika arbetssituationer.
    </p>
  </header>

      <div class="radar-inner">
        <canvas id="radarChart" height="340"></canvas>
      </div>

  {{ radar_labels|json_script:"radar-labels" }}
  {{ radar_values|json_script:"radar-values" }}

  {% if insights.most_natural and insights.needs_development %}
    <div class="overview-cards">

      <!-- Card 1: Mest naturligt -->
      <article class="overview-card">
        <div class="overview-card__top">
          <div class="mini-label">DITT MEST NATURLIGA BETEENDE</div>
          <h3 class="overview-card__title">{{ insights.most_natural.name }}</h3>
          {% if insights.most_natural.description %}
            <p class="overview-card__desc">{{ insights.most_natural.description }}</p>
          {% else %}
            <p class="overview-card__desc">
              Detta är ett beteende som faller dig naturligt och som du ofta använder utan större ansträngning.
            </p>
          {% endif %}
        </div>

        <div class="overview-card__bottom">
          <div class="mini-label">DET SOM GER DIG ENERGI</div>

          {% if insights.top_energy %}
            <div class="pill-list">
              {% for u in insights.top_energy %}
                <div class="pill">
                  <span class="pill__text">
                    Jag {% if u.short_statement %}{{ u.short_statement }}{% else %}upplever att {{ u.name|lower }} ofta stärker mitt driv{% endif %}
                  </span>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="pill-list">
              <div class="pill"><span class="pill__text">Jag får energi av att arbeta med tydlighet och riktning</span></div>
              <div class="pill"><span class="pill__text">Jag stärker samarbete genom att lyfta andra</span></div>
              <div class="pill"><span class="pill__text">Jag får energi när jag ser resultat av mitt arbete</span></div>
            </div>
          {% endif %}
        </div>
      </article>

      <!-- Card 2: Behöver utvecklas -->
      <article class="overview-card">
        <div class="overview-card__top">
          <div class="mini-label">BETEENDE DU BEHÖVER UTVECKLA</div>
          <h3 class="overview-card__title">{{ insights.needs_development.name }}</h3>
          {% if insights.needs_development.description %}
            <p class="overview-card__desc">{{ insights.needs_development.description }}</p>
          {% else %}
            <p class="overview-card__desc">
              Detta är ett beteende som kan kräva mer medveten ansträngning i vissa situationer, men som ofta går att stärka med små, konkreta steg.
            </p>
          {% endif %}
        </div>

        <div class="overview-card__bottom">
          <div class="mini-label">DET SOM TAR ENERGI FRÅN DIG</div>

          {% if insights.low_energy %}
            <div class="pill-list">
              {% for u in insights.low_energy %}
                <div class="pill">
                  <span class="pill__text">
                    Jag {% if u.short_statement %}{{ u.short_statement }}{% else %}kan uppleva att {{ u.name|lower }} tar mer energi än det ger{% endif %}
                  </span>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="pill-list">
              <div class="pill pill--muted"><span class="pill__text">Jag behöver mer energi när jag måste driva igenom beslut utan samsyn</span></div>
              <div class="pill pill--muted"><span class="pill__text">Jag blir trött när kommunikationen blir otydlig eller rörig</span></div>
              <div class="pill pill--muted"><span class="pill__text">Jag behöver extra ansträngning när jag måste växla tempo snabbt</span></div>
            </div>
          {% endif %}
        </div>
      </article>

    </div>
  {% endif %}

</section>

<!-- B3 RESULTAT -->
<section class="page page-results">

  <header class="page-header center">
    <h2 class="page-title-xl">Resultat på B3:s<br>ledarskapsbeteenden</h2>
    <p class="page-subtitle">
      Resultaten visas på en femgradig skala (1–5) där varje
      beteende <br>presenteras
      tillsammans med tillhörande underbeteenden.
    </p>
  </header>

  {% for cluster in b3_clusters %}
  <article class="result-card">

    <div class="result-card__top">

      <!-- Donut -->
      <div class="donut-wrap">
        {% if cluster.total_score != None and cluster.pct_total != None %}
          <div class="donut" style="--p: {{ cluster.pct_total|floatformat:4 }};">
            <div class="donut-label">
              <div class="donut-small">Totalt:</div>
              <div class="donut-value">{{ cluster.pct_total|floatformat:1 }}%</div>
            </div>
          </div>
        {% else %}
          <div class="donut donut--empty">
            <div class="donut-label">
              <div class="donut-small">Totalt:</div>
              <div class="donut-value">–</div>
            </div>
          </div>
        {% endif %}
      </div>

      <!-- Title + description -->
      <div class="result-main">
        <h3 class="result-title">{{ cluster.name }}</h3>

        {% if cluster.description %}
          <p class="result-desc">{{ cluster.description }}</p>
        {% else %}
          <p class="result-desc">
            På B3 innebär detta beteende ett tydligt, enkelt och begripligt språk,
            både internt och externt.
          </p>
        {% endif %}
      </div>

    </div>

    <!-- Underbehaviors list -->
    <div class="result-list">
      {% for u in b3_underbehaviors %}
        {% if u.cluster == cluster.name %}
          <div class="result-row">
            <div class="result-row__name">{{ u.name }}</div>

            <div class="b3-scale b3-scale--small" aria-label="Skala 1 till 5">
              {% with steps=u.score_5_half_steps %}
                {% if steps != None %}
                  {% for i in "12345" %}
                    {% with step=forloop.counter|add:forloop.counter %}
                      {% if steps >= step %}
                        <span class="dot dot--small is-on"></span>
                      {% elif steps == step|add:"-1" %}
                        <span class="dot dot--small is-half"></span>
                      {% else %}
                        <span class="dot dot--small"></span>
                      {% endif %}
                    {% endwith %}
                  {% endfor %}
                {% else %}
                  <span class="no-data">Ingen data</span>
                {% endif %}
              {% endwith %}
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

  </article>
  {% endfor %}

</section>

<section class="page page-mapping">

  <header class="page-header center">
    <div class="section-label">VISUELL MAPPNING</div>
    <h2 class="page-title-xl no-margin">B3-beteenden <br>→ TQ-kompetenser</h2>
    <p class="page-subtitle">
      Här visas hur varje B3-underbeteende är kopplat<br>till TQ-kompetenser enligt mappningen.
    </p>
  </header>

  {% for cluster in b3_clusters %}
    <article class="mapping-card">

      <div class="mapping-card__header">
        <h3 class="mapping-card__title">{{ cluster.name }}</h3>
      </div>

      <div class="mapping-card__body">

        {% for u in b3_underbehaviors %}
          {% if u.cluster == cluster.name %}

            <div class="ub-block">

              <!-- Underbehavior row -->
              <div class="ub-row">
                <div class="ub-name">{{ u.name }}</div>

                <div class="ub-right">
                  <div class="ub-small-label">Ditt resultat</div>

                  <div class="b3-scale b3-scale--small" aria-label="Skala 1 till 5">
                    {% with steps=u.score_5_half_steps %}
                      {% if steps != None %}
                        {% for i in "12345" %}
                          {% with step=forloop.counter|add:forloop.counter %}
                            {% if steps >= step %}
                              <span class="dot dot--small is-on"></span>
                            {% elif steps == step|add:"-1" %}
                              <span class="dot dot--small is-half"></span>
                            {% else %}
                              <span class="dot dot--small"></span>
                            {% endif %}
                          {% endwith %}
                        {% endfor %}
                      {% else %}
                        <span class="no-data">Ingen data</span>
                      {% endif %}
                    {% endwith %}
                  </div>
                </div>
              </div>

              <!-- Expand area with competencies -->
              <div class="ub-expand">

                <div class="ub-expand__title">Bakomliggande TQ-kompetenser</div>
                <div class="ub-expand__subtitle">Kompetenserna nedan bidrar till resultatet ovan</div>

                <div class="comp-list">
                    {% for comp in u.mapped_competencies %}
                      {% with score=comp.score %}
                      <div class="comp-item">
                        <div class="comp-left">
                          <div class="comp-name">{{ comp.name }}</div>
                          <div class="comp-desc">
                            Ger tydlig riktning och stöd i arbetssätt som skapar framdrift och trygghet.
                          </div>
                        </div>

                        <div class="comp-right">
                          <div class="comp-bar" style="--v:{% if score != None %}{{ score }}{% else %}0{% endif %};">
                            <span class="comp-fill"></span>
                          </div>

                          <div class="comp-meta">
                            <div class="comp-ticks">
                              <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    {% endwith %}
                  {% endfor %}
                </div>

              </div>
            </div>

          {% endif %}
        {% endfor %}

      </div>
    </article>
  {% endfor %}

</section>


